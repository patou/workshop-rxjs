<html>

<head>
  <link rel="stylesheet" href="revealjs/reveal.css">
  <link rel="stylesheet" href="revealjs/theme/white.css">
  <link rel="stylesheet" href="revealjs/plugin/highlight/zenburn.css" id="highlight-theme">
</head>

<body>
  <div class="reveal">
    <div class="slides">
      <section>
        <h1>RxJS</h1>
        <img src="https://gblobscdn.gitbook.com/spaces%2F-LwY_OXUQHvmdEoy0xNa%2Favatar.png?alt=media" />
        <p>Framework reactif</p>
      </section>
      <section>
        <section>Observable</section>
        <section>
          <p>Programmation reactive est un flux d'√©v√®nements, avec un d√©but et une fin (ou erreur)</p>
          <div class="fragment">
            <svg width="684" height="63"
              style="display: block; font-size: 14px; font-family: Arial, sans-serif; dominant-baseline: central; text-anchor: middle; cursor: default; user-select: none;">
              <g transform="translate(0, 11)">
                <g transform="translate(21, 0)">
                  <line x1="0" y1="26" x2="653" y2="26" stroke-width="2" stroke="rgba(0, 0, 0, 0.2)"
                    style="shape-rendering: crispedges;"></line>
                  <line x1="0" y1="26" x2="522.9224" y2="26" stroke-width="2" stroke="#000000"
                    style="shape-rendering: crispedges;"></line>
                  <path transform="translate(653, 21)" d="M0 0 L10 5 L0 10 z" fill="rgba(0, 0, 0, 0.2)"
                    style="transition: fill 0.2s ease-in-out 0s;"></path>
                  <line x1="522.9223999999999" y1="3.5" x2="522.9223999999999" y2="48.5" stroke-width="2"
                    stroke="#000000" style="opacity: 1; transition: opacity 0.5s ease-in-out 0s;"></line>
                  <g>
                    <g
                      style="transform: translate(130.731px, 26px) scale(1); transition: transform 0.5s ease-in-out 0s;">
                      <circle cx="0" cy="0" r="15" stroke-width="2" stroke="#000000" fill="#ffffff"></circle><text x="0"
                        y="0" style="fill: rgb(0, 0, 0); dominant-baseline: central;">0</text>
                    </g>
                    <g
                      style="transform: translate(261.331px, 26px) scale(1); transition: transform 0.5s ease-in-out 0s;">
                      <circle cx="0" cy="0" r="15" stroke-width="2" stroke="#000000" fill="#ffffff"></circle><text x="0"
                        y="0" style="fill: rgb(0, 0, 0); dominant-baseline: central;">1</text>
                    </g>
                    <g
                      style="transform: translate(391.931px, 26px) scale(1); transition: transform 0.5s ease-in-out 0s;">
                      <circle cx="0" cy="0" r="15" stroke-width="2" stroke="#000000" fill="#ffffff"></circle><text x="0"
                        y="0" style="fill: rgb(0, 0, 0); dominant-baseline: central;">2</text>
                    </g>
                    <g
                      style="transform: translate(522.661px, 26px) scale(1); transition: transform 0.5s ease-in-out 0s;">
                      <circle cx="0" cy="0" r="15" stroke-width="2" stroke="#000000" fill="#ffffff"></circle><text x="0"
                        y="0" style="fill: rgb(0, 0, 0); dominant-baseline: central;">3</text>
                    </g>
                  </g>
                </g>
              </g>
              <g style="text-anchor: start; dominant-baseline: text-before-edge;"></g>
            </svg>
          </div>
          <div class="fragment">
            <svg width="804" height="63"
              style="display: block; font-size: 14px; font-family: Arial, sans-serif; dominant-baseline: central; text-anchor: middle; cursor: default; user-select: none;">
              <g transform="translate(0, 11)">
                <g transform="translate(21, 0)">
                  <line x1="0" y1="26" x2="773" y2="26" stroke-width="2" stroke="rgba(0, 0, 0, 0.2)"
                    style="shape-rendering: crispedges;"></line>
                  <line x1="0" y1="26" x2="618.4" y2="26" stroke-width="2" stroke="#000000"
                    style="shape-rendering: crispedges;"></line>
                  <path transform="translate(773, 21)" d="M0 0 L10 5 L0 10 z" fill="rgba(0, 0, 0, 0.2)"
                    style="transition: fill 0.2s ease-in-out 0s;"></path>
                    <g>
                      <g
                        style="transform: translate(130.731px, 26px) scale(1); transition: transform 0.5s ease-in-out 0s;">
                        <circle cx="0" cy="0" r="15" stroke-width="2" stroke="#000000" fill="#ffffff"></circle><text x="0"
                          y="0" style="fill: rgb(0, 0, 0); dominant-baseline: central;">0</text>
                      </g>
                      <g
                        style="transform: translate(261.331px, 26px) scale(1); transition: transform 0.5s ease-in-out 0s;">
                        <circle cx="0" cy="0" r="15" stroke-width="2" stroke="#000000" fill="#ffffff"></circle><text x="0"
                          y="0" style="fill: rgb(0, 0, 0); dominant-baseline: central;">1</text>
                      </g>
                      <g
                        style="transform: translate(391.931px, 26px) scale(1); transition: transform 0.5s ease-in-out 0s;">
                        <circle cx="0" cy="0" r="15" stroke-width="2" stroke="#000000" fill="#ffffff"></circle><text x="0"
                          y="0" style="fill: rgb(0, 0, 0); dominant-baseline: central;">2</text>
                      </g>
                      <g
                        style="transform: translate(522.661px, 26px) scale(1); transition: transform 0.5s ease-in-out 0s;">
                        <circle cx="0" cy="0" r="15" stroke-width="2" stroke="#000000" fill="#ffffff"></circle><text x="0"
                          y="0" style="fill: rgb(0, 0, 0); dominant-baseline: central;">3</text>
                      </g>
                    </g>
                  <g style="opacity: 1; transition: opacity 0.5s ease-in-out 0s;">
                    <line x1="609.4000000000001" y1="17" x2="627.4000000000001" y2="35" stroke-width="2"
                      stroke="#000000"></line>
                    <line x1="609.4000000000001" y1="35" x2="627.4000000000001" y2="17" stroke-width="2"
                      stroke="#000000"></line>
                    <rect x="609.4000000000001" y="17" width="18" height="18" fill="transparent"></rect>
                  </g>
                </g>
              </g>
              <g style="text-anchor: start; dominant-baseline: text-before-edge;"></g>
            </svg>
          </div>
        </section>
        <section>
          <h3>Exemple de flux</h3>
          <ul>
            <li class="fragment">Clic sur un bouton</li>
            <li class="fragment">Requete HTTP</li>
            <li class="fragment">Connexion/d√©connexion d'un utilisateur</li>
            <li class="fragment">Saisie dans un champs texte</li>
            <li class="fragment">Changement des param√®tres de l'url</li>
            <li class="fragment">Horloge</li>
          </ul>
        </section>
        <section>
          <h1>Observable</h1>
          <p class="fragment">Emet des √©v√®nements</p>
          <p class="fragment">Permet de s'abonner aux √©v√®nements</p>
          <p class="fragment">Notifie tous ceux qui se sont abonn√© lorsqu'il envoie un √©v√®nement</p>
        </section>
        <section>
          <h3>Trois √©tats</h3>
          <ul>
            <li>Next: Nouvel √©l√©ment dans le flux</li>
            <li>Complete: Le flux est termin√©</li>
            <li>Error: Le flux est termin√© par une erreur</li>
          </ul>
        </section>
        <section>
          <pre><code data-trim data-noescape>
            const source = Observable.create((observer) => {
              observer.next('Bonjour');
              observer.next('le monde !');
              observer.error(new Error('Erreur. :/'));
              observer.complete();
            });
            </code></pre>
        </section>
        <section>
          <h3>S'abonner √† un observable</h3>
          <pre><code data-trim data-noescape>
            source.subscribe(
              (data) => displayMessage(data),
              (error) => console.error('error', error),
              () => console.log('complete')
            )
            </code></pre>
        </section>
        <section>
          <h3>of</h3>
          <pre><code data-trim data-noescape>
            of(1, 2, 3, 4, 5)
            </code></pre>
          <p>Cr√©e un observable sur plusieurs valeurs statique (utile pour les test, ou envoyer une valeur unique)</p>
        </section>
        <section>
          <h3>interval</h3>
          <pre><code data-trim data-noescape>
            interval(1000)
            </code></pre>
          <p>Envoi un nombre qui s'incr√©mente toute les 1000 ms (1 seconde)</p>
        </section>
        <section>
          <h3>fromEvent</h3>
          <pre><code data-trim data-noescape>
            fromEvent(button, 'click')
            </code></pre>
          <p>S'abonne √† un √©v√®nement DOM</p>
        </section>
      </section>
      <section>
        <section>Subject</section>
        <section>
          <h3>Subject</h3>
          <img src="img/S.PublishSubject.png" class="r-stretch"/>
          <p class="fragment">Observable qui expose l'API Observer (m√©thodes next, complete, error)</p>
        </section>
        <section>
          <h3>BehaviorSubject</h3>
          <img src="img/S.BehaviorSubject.png" class="r-stretch"/>
          <p class="fragment">Lorsque l'on subscribe, on r√©cup√®re la derni√®re valeur ou la valeur par d√©faut</p>
        </section>
        <section>
          <h3>ReplaySubject</h3>
          <img src="img/S.ReplaySubject.png" class="r-stretch"/>
          <p class="fragment">Lorsque l'on subscribe, on r√©cup√®re toutes les valeurs d√©j√† envoy√© dans le flux</p>
        </section>
        <section>
          <h3>AsyncSubject</h3>
          <img src="img/S.AsyncSubject.png" class="r-stretch"/>
          <p class="fragment">On re√ßoit simplement la derni√®re valeur lorsque le flux est finit</p>
        </section>
      </section>
      <section>
        <section>Operators</section>
        <section>
          <pre><code data-trim data-noescape>
                of(1, 2, 3, 4, 5)
                .pipe(
                    filter(x => x % 2 === 0),
                    map(x => x + 1),
                )
                .subscribe(console.log);
                </code></pre>
        </section>
        <section>
          <h3>Operateur</h3>
          <ul>
            <li class="fragment">Permet de faire des modifications sur les donne√©s du flux</li>
            <li class="fragment">Un op√©rateur s'abonne √† un observable et retourne un autre observable</li>
            <li class="fragment">Les op√©rateurs sont enchainn√© par la m√©thode pipe(op1(), op2(), ...)</li>
          </ul>
        </section>
        <section>
          <h3>Map</h3>
          <img src="img/map.png" class="r-stretch"/>
          <p class="fragment">Applique une fonction de transformation √† chaque √©l√©ment du flux</p>
        </section>
        <section>
          <h3>Filter</h3>
          <img src="img/filter.png" class="r-stretch"/>
          <p class="fragment">Ne laisse passer dans le flux que les √©l√©ment qui valident la condition</p>
        </section>
        <section>
          <h3>Scan</h3>
          <img src="img/scan.png" class="r-stretch"/>
          <p class="fragment">Reduit au fur et mesure la donn√©e avec un accumulateur (identique que reduce, sauf que reduce envoie √† la fin le r√©sultat)</p>
        </section>
        <section>
          <h3>Take</h3>
          <img src="img/take.png" class="r-stretch"/>
          <p class="fragment">Prend x √©l√©ment et arr√™te le flux</p>
        </section>
        <section>
          <h3>TakeWhile</h3>
          <img src="img/takeWhile.png" class="r-stretch"/>
          <p class="fragment">Prend les √©l√©ment tant que la condition est vrai</p>
        </section>
        <section>
          <h3>Merge</h3>
          <img src="img/merge.png" class="r-stretch"/>
          <p class="fragment">Merge plusieurs flux dans un seul flux</p>
        </section>
        <section>
          <h3>Cr√©er un op√©rateur custom</h3>
          <pre><code data-trim data-noescape>
            const plusX = (x: number) => source$ => Observable.create(observer =>
              source$.subscribe(
                value => {
                  observer.next(value + x);
                },
                err => observer.error(err),
                () => observer.complete()
              )
            );
            </code></pre>
        </section>
        <section>
          <h3>Cr√©er un op√©rateur custom</h3>
          <pre><code data-trim data-noescape>
            const plusX = (x: number) => map(value => value + 1);
            </code></pre>
        </section>
      </section>
      <section>
        <section>TP</section>
        <section>
          <h1>Utilisation du site <a href="https://rxviz.com">rxviz.com</a></h1>
          <p class="fragment">Ce site permet de visualiser des flux rxjs, et √©crire son propre code</p>
          <p class="fragment">Pr√©sente d√©j√† des exemples utilisable</p>
        </section>
        <section>
          <p>Faire les imports</p>
          <pre><code data-trim data-noescape>
            const { interval } = Rx;
            const { map } = RxOperators;
            // Equivalent √† 
            import { interval } from 'rxjs';
            import { map } from 'rxjs/operators';
            </code></pre>
        </section>
        <section>
          <p class="fragment">Pour une visualisation, il faut utiliser l'observable interval</p>
          <p class="fragment">La derni√®re ligne doit retourner un observable (l'outil fait un subscribe)</p>
          <pre><code data-trim data-noescape>
            const { interval } = Rx;
            const { map } = RxOperators;
            
            interval(1000) // Envoi toutes les secondes un nombre qui s'autoincr√©mente
            .pipe(
              map(x => x + 1) // les op√©rateurs que l'on fait
            )
            </code></pre>
        </section>
        <section>
          <h2><b>TP1</b>) Compteur</h2>
          <a href="https://rxviz.com/examples/custom">Partir de ce code</a>
          <p class="fragment">Faire un conteur de 5 valeur (1, 2, 3, 4, 5) </p>
          <p class="fragment">Ne garder que les nombres paire <span style="font-family: monospace;background-color: lightgrey;">% 2 === 2</span>)</p>
          <p class="fragment">Multiplier le code par 2</p>
        </section>
        <section>
          <h2><b>TP2</b>) Autocompl√©tion</h2>
          <a href="https://rxviz.com/examples/input-element">Partir de ce code</a>
          <p class="fragment">S'abonner √† champ input et √©mettre les caract√®res (d√©j√† fait)</p>
          <p class="fragment">Agr√©ger les caract√®res en des mots</p>
          <p class="fragment">N'envoyer un √©l√®ment que toutes les secondes</p>
          <p class="fragment">Arr√™ter le flux lorsque que l'on tappe Enter</p>
        </section>
        <section>
          <h2><b>TP3</b>) Pagination et trie</h2>
          <p class="fragment">Cr√©er deux boutons, un pour changer de page, un pour inverser le trie</p>
          <p class="fragment">Pour chaque clic sur le bouton de page, incr√©menter la page</p>
          <p class="fragment">Pour chaque clic sur le bouton de trie, inverser le sens du trie</p>
          <p class="fragment">Combiner les deux derni√®re valeur pour lancer le rafraichissement de la page</p>
        </section>
        <section>
          <h2><b>TP3</b>) Pagination et trie</h2>
          <img src="img/tp3.jpg"/>
        </section>
        <section>
          <h2><b>TP4</b>) Triple clic</h2>
          <p>Afficher un c lorsque l'on fait un triple clic </p>
        </section>
        <section>
          <h3>Solution TP 1</h3>
          <pre><code data-trim data-noescape>
const { interval } = Rx;
const { take, map, filter } = RxOperators;
  
interval(1000)
.pipe(
  take(5),
  filter(x => x % 2 === 0),
  map(x => x * 2)
  );
            </code></pre>
        </section>
        <section>
          <a href="https://stackblitz.com/edit/rxjs-forkjoin-exercise-001">Challenges RXJS</a>
        </section>
        <section>
          Solutions
        </section>
        <section>
          Ne trichez pas üßê
        </section>
        <section>
          <h3>Solution TP 2</h3>
          <pre><code data-trim data-noescape>
const { fromEvent } = Rx;
const { map, filter, scan, debounceTime, takeWhile } = RxOperators;

const input = document.createElement('input');
input.setAttribute('placeholder', 'Type something');
output.prepend(input);
input.focus();

fromEvent(input, 'keydown').pipe(
  map(e => e.key),
  takeWhile(key => key !== 'Enter'),
  filter(key => key !== ' '),
  scan((acc, valeur) => acc + valeur),
  debounceTime(1000)
)
            </code></pre>
        </section>
        <section>
          <h3>Solution TP 3 : Cr√©ation des boutons</h3>
          <img src="img/tp3.jpg"/>
          <pre><code data-trim data-noescape>
            const { fromEvent, combineLatest } = Rx;
            const { map, filter, scan, tap, startWith } = RxOperators;
            
            const pageButton = document.createElement('button');
            pageButton.innerText = 'Page 0';
            
            const sortButton = document.createElement('button');
            sortButton.innerText = 'a';
            
            output.prepend(pageButton);
            output.prepend(sortButton);
          </code></pre>
        </section>
        <section>
          <p>Bouton page</p>
          <pre><code data-trim data-noescape>
            const page$ = fromEvent(pageButton, 'click').pipe(
              startWith(1),
              scan(acc => acc+1),
              tap(page => pageButton.innerText = `Page ${page}`)
            )
          </code></pre>
          <p>Bouton Trie</p>
          <pre><code data-trim data-noescape>
            const sort$ = fromEvent(sortButton, 'click').pipe(
              startWith(true),
              scan(acc => !acc),
              map(sort => sort ? 'a' : 'z'),
              tap(sort => sortButton.innerText = sort)
            )
          </code></pre>
            <p>Combiner les trie et sort</p>
            <pre><code data-trim data-noescape>
              combineLatest(page$, sort$).pipe(map(([page, sort]) => page+sort))
            </code></pre>
        </section>
        <section>
          <h3>TP4) Triple Clic</h3>
          <pre><code data-noescape data-trim>
const { fromEvent } = Rx;
const { mapTo, filter, bufferTime } = RxOperators;

fromEvent(document, 'click').pipe(
  bufferTime(1000),
  filter(clicks => clicks.length === 3),
  mapTo('c')
)
          </code></pre>
        </section>
      </section>
      <section>
        <h3>Liens</h3>
        <ul>
          <li class="fragment"><a href="http://reactivex.io/">reactivex.io</a></li>
          <li class="fragment"><a href="https://www.learnrxjs.io/">learnrxjs.io</a></li>
          <li class="fragment"><a href="https://rxmarbles.com/">rxmarbles.com</a></li>
          <li class="fragment"><a href="https://rxviz.com/">rxviz.com</a></li>
          <li class="fragment"><a href="https://reactive.how/">reactive.how</a></li>
          <li class="fragment"><a href="https://www.julienpradet.fr/tutoriels/introduction-a-rxjs/">Intro par Julien Pradet</a></li>
        </ul>
      </section>
    </div>
  </div>
  <script src="revealjs/reveal.js"></script>
  <script src="revealjs/plugin/highlight/highlight.js"></script>
  <script>
    Reveal.initialize({
      slideNumber: true,
      hash: true,
      plugins: [RevealHighlight]
    });
  </script>
</body>

</html>